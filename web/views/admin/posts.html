{% extends "base.html" %}
{% block title %}All Posts{% endblock %}
{% block body %}
	<h2>All Posts</h2>
	<a href='/admin/post'>Write a post.</a>
	{% ifnotequal last_post -1 %}
		<p>Posts {{offset|add:1}} to {{last_post|add:1}}</p>
		<table>
			<thead>
				<tr><th>Title</th><th>Published</th><th>Actions</th></tr>
			</thead>
			{% for post in posts %}
				<tr>
					<td>
						<a href='{{ post.path.edit }}'>{{ post.title|escape }}</a>
					</td>
					<td>
						{% if post.draft %}
							Draft
						{% else %}
							{{ post.published|date:"Y-m-d" }}
						{% endif %}
					</td>
					<td>
						{% if post.draft %}
							<a href='{{ post.path.preview }}'>Preview |</a>
						{% else %}
							<a href='{{ post.path.view }}'>View |</a>
						{% endif %}
						<a href='{{ post.path.edit }}'>Edit |</a>
						<form class='delete' action='{{ post.path.delete }}' method='post'>
							<a href='#' class='delete'>Delete</a>
						</form>
					</td>
				</tr>
			{% endfor %}
		</table>
	{% else %}
		<p>
			No posts yet.
		</p>
	{% endifnotequal %}
	{% ifnotequal offset 0 %}
		<a href='?start={{prev_offset}}&count={{count}}'>&laquo; Previous</a>
	{% endifnotequal %}
	{% if posts|length_is:count %}
		<a href='?start={{next_offset}}&count={{count}}'>Next &raquo;</a>
	{% endif %}

{% endblock %}
{% block scripts %}
<script>
	jQuery( function( $ ){

		$( ".delete" ).click( function( event ) {
			var self = $( this );
			if ( confirm( "Delete this post?" ) ) {
				self.closest( "form" ).submit();
			}
			return false;
		})

	});
</script>
{% endblock %}
